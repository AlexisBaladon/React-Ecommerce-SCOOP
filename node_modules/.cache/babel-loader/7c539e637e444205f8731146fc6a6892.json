{"ast":null,"code":"import _slicedToArray from\"F:\\\\reactApp\\\\heladeria-e-commerce-baladon\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\slicedToArray.js\";import React,{useContext,useEffect,useState}from'react';import{Link}from'react-router-dom';import{CartContext}from'../../../context/cartContext';import{Button,Col,Row}from'react-bootstrap';import ItemChoserContainer from'./itemChoserContainer';import ItemCount from'./itemCount';import ItemCategory from'../../../dataTypes/category';import{createTicket}from'../../../helpers/itemFactory';import ProductDetailSimple from'../../../dataTypes/ProductDetailSimple';import'./itemDetail.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var ItemDetail=function ItemDetail(_ref){var item=_ref.item;//Cart context\nvar cartContext=useContext(CartContext);//Item destructuring\nvar _ref2=[item.id,item.title,item.description,item.price,item.pictureUrl,item.stock,item.category],itemId=_ref2[0],title=_ref2[1],description=_ref2[2],price=_ref2[3],pictureUrl=_ref2[4],stock=_ref2[5],category=_ref2[6];//Product details (different categories have different details)\nvar _useState=useState(new ProductDetailSimple()),_useState2=_slicedToArray(_useState,2),productDetail=_useState2[0],setProductDetail=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),inCart=_useState4[0],setInCart=_useState4[1];var _useState5=useState(cartContext.amountInCart(itemId)),_useState6=_slicedToArray(_useState5,2),amountInCart=_useState6[0],setAmountInCart=_useState6[1];var _useState7=useState(\"Producto agregado al carrito!\"),_useState8=_slicedToArray(_useState7,2),inCartMessage=_useState8[0],setInCartMessage=_useState8[1];useEffect(function(){setInCart(cartContext.isInCart(itemId,productDetail));if(amountInCart>=stock){setInCart(true);setInCartMessage(\"No queda stock para este producto!\");}},[productDetail,amountInCart,cartContext,itemId,stock]);//ItemCount\nvar initial=0;var increase=function increase(productCount,setProductCount){if(productCount<stock&&amountInCart+productCount<stock)setProductCount(productCount+1);};var decrease=function decrease(productCount,setProductCount){if(productCount>0)setProductCount(productCount-1);};//Add to cart\nvar onAdd=function onAdd(productCount){if(productCount>0){try{//Almost every function here throws an exception\nvar newTicket=createTicket(item,productDetail,productCount);cartContext.addItem(newTicket);setInCart(cartContext.isInCart(itemId,productDetail));setAmountInCart(cartContext.amountInCart(itemId));if(amountInCart>stock){throw new Error(\"La cantidad de items en el carrito supera al stock\");}}catch(err){if(err instanceof Error){//If something goes wrong, items won't be able to get added\nconsole.warn(err.message);setInCartMessage(err.message);setInCart(true);}}}};//Image size according to category\nvar imgWidth=new Map([[ItemCategory.Paleta,\"450px\"],[ItemCategory.Recipiente,\"575px\"],[ItemCategory.Postre,\"600px\"]]);return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"div\",{id:\"item-detail\",children:/*#__PURE__*/_jsxs(Row,{id:\"info-item-detail\",className:\"align-items-center\",children:[/*#__PURE__*/_jsx(Col,{xl:\"6\",id:\"img-container-item-detail\",className:\"justify-content-center\",children:/*#__PURE__*/_jsx(_Fragment,{children:category!==ItemCategory.Recipiente?/*#__PURE__*/_jsx(\"img\",{id:\"img-item-detail\",width:imgWidth.get(category),src:pictureUrl,alt:\"Imagen \"+title}):/*#__PURE__*/_jsxs(Row,{className:\"justify-content-center\",children:[/*#__PURE__*/_jsx(\"div\",{id:\"title-item-choser\",children:/*#__PURE__*/_jsx(\"h3\",{children:\"Personaliza tu helado:\"})}),/*#__PURE__*/_jsx(ItemChoserContainer,{id:itemId,setProductDetail:setProductDetail})]})})}),/*#__PURE__*/_jsx(Col,{xl:\"6\",id:\"text-info-item-detail\",className:\"d-flex justify-content-center\",children:/*#__PURE__*/_jsxs(\"div\",{id:\"text-info-inner-item-detail\",children:[/*#__PURE__*/_jsx(\"div\",{id:\"title-item-detail\",children:/*#__PURE__*/_jsx(\"h3\",{children:title})}),/*#__PURE__*/_jsx(\"p\",{id:\"description-item-detail\",children:description}),/*#__PURE__*/_jsxs(\"h1\",{id:\"price-item-detail\",children:[price,\" US$\"]}),/*#__PURE__*/_jsxs(\"div\",{id:\"bottom-info-item-detail\",children:[/*#__PURE__*/_jsxs(\"div\",{id:\"cart-stock-item-detail\",children:[/*#__PURE__*/_jsxs(\"p\",{id:\"stock-item-detail\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Stock:\"}),\" \",stock]}),/*#__PURE__*/_jsxs(\"small\",{id:\"in-cart-item-detail\",children:[\"(\",amountInCart,\" en carrito)\"]})]}),/*#__PURE__*/_jsx(Row,{className:\"item-count-container \",children:inCart?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{style:{fontStyle:\"italic\"},children:/*#__PURE__*/_jsxs(\"p\",{style:{marginBottom:\"0px\"},children:[\" \",inCartMessage,\" \"]})}),/*#__PURE__*/_jsx(Link,{to:\"/cart\",children:/*#__PURE__*/_jsx(\"div\",{className:\"py-2\",children:/*#__PURE__*/_jsx(Button,{className:\"add-cart\",variant:\"primary\",children:\"Terminar mi compra\"})})})]}):/*#__PURE__*/_jsx(ItemCount,{stock:stock,initial:initial,increase:increase,decrease:decrease,onAdd:onAdd})})]})]})})]})})});};export default ItemDetail;","map":{"version":3,"sources":["F:/reactApp/heladeria-e-commerce-baladon/src/components/items/detail/itemDetail.tsx"],"names":["React","useContext","useEffect","useState","Link","CartContext","Button","Col","Row","ItemChoserContainer","ItemCount","ItemCategory","createTicket","ProductDetailSimple","ItemDetail","item","cartContext","id","title","description","price","pictureUrl","stock","category","itemId","productDetail","setProductDetail","inCart","setInCart","amountInCart","setAmountInCart","inCartMessage","setInCartMessage","isInCart","initial","increase","productCount","setProductCount","decrease","onAdd","newTicket","addItem","Error","err","console","warn","message","imgWidth","Map","Paleta","Recipiente","Postre","get","fontStyle","marginBottom"],"mappings":"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","sourcesContent":["import React, { useContext, useEffect, useState } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport { CartContext } from '../../../context/cartContext';\r\nimport { Button, Col, Row } from 'react-bootstrap';\r\n\r\nimport ItemChoserContainer from './itemChoserContainer';\r\nimport ItemCount from './itemCount';\r\n\r\nimport ItemTicket from '../../../dataTypes/itemTicket';\r\nimport ItemShowCase from '../../../dataTypes/itemShowcase';\r\nimport ItemCategory from '../../../dataTypes/category';\r\nimport ProductDetail from '../../../dataTypes/ProductDetail';\r\nimport { createTicket } from '../../../helpers/itemFactory';\r\nimport ProductDetailSimple from '../../../dataTypes/ProductDetailSimple';\r\n\r\nimport './itemDetail.css';\r\n\r\ninterface IProps {\r\n  item: ItemShowCase;\r\n}\r\n\r\nconst ItemDetail: React.FC<IProps> = ({item}: IProps) => {\r\n\r\n  //Cart context\r\n  const cartContext = useContext(CartContext);\r\n\r\n  //Item destructuring\r\n  const [itemId, title, description, price, pictureUrl, stock, category]:\r\n        [string, string, string, number, string, number, ItemCategory] =\r\n        [item.id, item.title, item.description, item.price, item.pictureUrl, item.stock, item.category];\r\n\r\n  //Product details (different categories have different details)\r\n  const [productDetail, setProductDetail] = useState<ProductDetail>(new ProductDetailSimple());\r\n  const [inCart, setInCart] = useState<boolean>(false);\r\n  const [amountInCart, setAmountInCart] = useState<number>(cartContext.amountInCart(itemId));\r\n  const [inCartMessage, setInCartMessage] = useState(\"Producto agregado al carrito!\");\r\n\r\n  useEffect(() => {\r\n    setInCart(cartContext.isInCart(itemId, productDetail));\r\n    if (amountInCart >= stock) {\r\n      setInCart(true);\r\n      setInCartMessage(\"No queda stock para este producto!\");\r\n    }\r\n  }, [productDetail, amountInCart,   cartContext, itemId, stock])\r\n\r\n  //ItemCount\r\n  const initial: number = 0;\r\n  \r\n  const increase = (productCount: number, setProductCount:(pc: number) => any): void => {\r\n    if ((productCount < stock) && (amountInCart + productCount < stock)) setProductCount(productCount + 1);\r\n  }\r\n  \r\n  const decrease = (productCount: number, setProductCount:(pc: number) => any): void => {\r\n    if (productCount > 0) setProductCount(productCount - 1);\r\n  }\r\n\r\n  //Add to cart\r\n  const onAdd = (productCount: number): void => {\r\n    if (productCount > 0) {\r\n      try {\r\n        //Almost every function here throws an exception\r\n        const newTicket: ItemTicket = createTicket(item, productDetail, productCount);\r\n        cartContext.addItem(newTicket);\r\n        setInCart(cartContext.isInCart(itemId,productDetail));\r\n        setAmountInCart(cartContext.amountInCart(itemId));\r\n        if (amountInCart > stock) {\r\n          throw new Error(\"La cantidad de items en el carrito supera al stock\");\r\n        }\r\n      }\r\n      catch (err: any) {\r\n        if (err instanceof Error) {\r\n          //If something goes wrong, items won't be able to get added\r\n          console.warn(err.message);\r\n          setInCartMessage(err.message);\r\n          setInCart(true);\r\n        }\r\n      }\r\n    }\r\n  }\r\n  \r\n  //Image size according to category\r\n  const imgWidth = new Map([[ItemCategory.Paleta    , \"450px\"],\r\n                            [ItemCategory.Recipiente, \"575px\"],\r\n                            [ItemCategory.Postre    , \"600px\"],\r\n                          ])\r\n\r\n  return <>\r\n    <div id=\"item-detail\">\r\n      <Row id=\"info-item-detail\" className=\"align-items-center\">\r\n        <Col xl=\"6\" id=\"img-container-item-detail\" className=\"justify-content-center\">\r\n          {/* Dynamically selected component*/}\r\n          <>{\r\n            category!==ItemCategory.Recipiente?\r\n              <img id=\"img-item-detail\" width={imgWidth.get(category)} \r\n                  src={pictureUrl} alt={\"Imagen \"+title} />\r\n              :\r\n              <Row className=\"justify-content-center\">\r\n                <div id=\"title-item-choser\"><h3>Personaliza tu helado:</h3></div>\r\n                <ItemChoserContainer id={itemId} setProductDetail={setProductDetail}/>\r\n              </Row>\r\n            }</>\r\n        </Col>\r\n        <Col xl=\"6\" id=\"text-info-item-detail\" className=\"d-flex justify-content-center\">\r\n          <div id=\"text-info-inner-item-detail\">\r\n            <div id=\"title-item-detail\">\r\n              <h3>{title}</h3>\r\n            </div>\r\n            <p id=\"description-item-detail\">{description}</p>\r\n            <h1 id=\"price-item-detail\">{price} US$</h1>\r\n            <div id=\"bottom-info-item-detail\">\r\n              <div id=\"cart-stock-item-detail\">\r\n                <p id=\"stock-item-detail\"><strong>Stock:</strong> {stock}</p>\r\n                <small id=\"in-cart-item-detail\">({amountInCart} en carrito)</small>\r\n              </div>\r\n              <Row className = \"item-count-container \">\r\n                {/* Dynamically selected component*/}\r\n                {inCart ?\r\n                <>\r\n                  <div style={{fontStyle:\"italic\"}}>\r\n                    <p style={{marginBottom:\"0px\"}}> {inCartMessage} </p>\r\n                  </div>\r\n                  <Link to=\"/cart\">\r\n                    <div className = \"py-2\">\r\n                      <Button className = \"add-cart\" variant=\"primary\">Terminar mi compra</Button>\r\n                    </div>\r\n                  </Link>\r\n                </>\r\n                :\r\n                <ItemCount\r\n                  stock = {stock}\r\n                  initial = {initial}\r\n                  increase = {increase}\r\n                  decrease = {decrease}\r\n                  onAdd = {onAdd}\r\n                />}\r\n              </Row>\r\n            </div>\r\n          </div>\r\n        </Col>\r\n      </Row>\r\n    </div>\r\n  </>\r\n}\r\n\r\nexport default ItemDetail;"]},"metadata":{},"sourceType":"module"}